# Vali
Vali analyzes PRM raw files acquired by Thermo-Fisher Orbitrap instruments. It is optimized to work with [Picky](https://picky.mdc-berlin.de) generated spectrum libraries and provides semi-automated peak determination. All peak assignments can be manually adjusted or corrected. Subsequently, quantified fragment peaks can be exported as tab delimited text files.
## Requirements
* R > 4.0.3
* [Rawrr Requirements](https://github.com/fgcz/rawrr):
    * [Mono](https://www.mono-project.com)
    * [MS .Net Framework](https://dotnet.microsoft.com/download)
### Packages:
    ## Required R-Packages
The following packages are required for full functionality of Vali:
* shiny 1.7.1
* RSQLite 2.2.10
* pracma 2.3.6
* data.table 1.14.2
* parallel 4.1.2
* gtools 3.9.2
* h2o 3.36.0.2
* Peptides 2.4.4
* enviPat 2.4
* shinyWidgets 0.6.4
* tcltk 4.1.2
* rawDiag (obsolete, not used anymore)
* rawrr 1.3.3
 * You must set '.' as decimal seperator in your system. 

## Getting Started
1. Start Vali
    * Vali.bat (Windows)
    * Vali.sh (Linux or MacOs)
2. Go to the RawScanner Tab.
3. Set the Path to the Main Analysis folder, which contains your raw files (PRM, tDIA or DIA).
4. Set the Picky Export folder path. This folder must be the exact same one you exported from Picky. 
5. Choose the correct analysis mode (PRM or DIA) and adjust the mass accuracy settings. Leave the Recompile Database unset.
6. Press GO and wait for the program to finalize the analysis.
## Manual adjustments
The Validation Tool Panel allows you to go through all peptides and readjust the peak selection.

1. Use the mouse over to define the RT range of the peak and double click. 
2. Press the Set button. The corresponding area will be highlighted in grey. You can remove a peak definition by pressing the Remove button.
3. (Optional) You can rate the quality of the peak with the Rating buttons.

## Export
Press the Export button in the upper right Corner. After all sequences have been analysed Vali will provide you with the following list of tables:
1. TransitionList.txt (Quantitative information of Transitions, use this table for downstream analysis).
2. Peaks.txt (for replotting the peaks, or downstream analysis such as lm based ratio analysis.)
4. Ratios.txt (for SILAC pairs)

## Known issues
* The MS1 read out function and the AreaSearch function is at the moment not working due to substantial changes in the internal data management.
* The fragment selection and exclusion does not work properly. The current workarround is to document bad transitions in order to remove them manually in a downstream analysis step. 

## Libraries
At the moment Vali can only read libraries generated by Picky. With ConvertMSMStoPicky you can manually convert MQ obtained msms.txt files into libraries.



## Citation
If you use Vali alone, please cite this git, if you use Vali in combination with Picky please also cite Picky:

* Zauber et al. (2018). Nature Methods. http://doi.org/10.1038/nmeth.4607


